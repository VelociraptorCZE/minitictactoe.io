!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o=Object.keys(window).filter(function(e){return/^on/.test(e)});if(!o.length)for(var r in document)/^on/.test(r)&&o.push(r);var i=o;function a(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t instanceof Element?t:document.querySelector(t),this.setState(n),this.onMount()}var t,n,o;return t=e,(n=[{key:"setState",value:function(e){var t=this;this.state=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){c(e,t,n[t])})}return e}({},this.state,e);var n=this.container;!function(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}(n),n.insertAdjacentHTML("beforeend",this.render(this.state)||""),function(e){u(e.querySelectorAll("[escapedContent]")).forEach(function(e){e.insertAdjacentText("beforeend",e.getAttribute("escapedContent")),e.removeAttribute("escapedContent")})}(n),i.forEach(function(e){return function(e){var t=this;a(this.container.querySelectorAll("[".concat(e,"]"))).forEach(function(n){var o=n.getAttribute(e);n.addEventListener(e.slice(2),function(e){return t[o](e)}),n.removeAttribute(e)})}.bind(t)(e)}),this.onRender()}},{key:"onMount",value:function(){}},{key:"onRender",value:function(){}},{key:"render",value:function(){}}])&&l(t.prototype,n),o&&l(t,o),e}();function f(){for(var e="",t=0;t<11;t++){if(!!Math.round(Math.random()))e+=Math.round(9*Math.random());else{var n=65+Math.round(25*Math.random());e+=String.fromCharCode(n)}}return e}var m=io();function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o={createRoomForm:!1,joinRoomForm:!1};return(n=p(this,b(t).call(this,document.body,o))).initialState=o,n.setUserData(e),n.joinGameFromLink(),n}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,s),n=t,(o=[{key:"setUserData",value:function(e){e.name=f(),this.userData=e}},{key:"joinGameFromLink",value:function(){var e=location.pathname.match(/(?!\/game\/)\w+$/);e&&this.joinRoomOnServer(e.toString())}},{key:"selectInput",value:function(e){e.target.select(),document.execCommand("copy");var t=document.getElementById("linkCopied");t.style.display="block",setTimeout(function(){t.style.display="none"},2e3)}},{key:"createRoomOnServer",value:function(e,t){m.emit("createRoom",{roomId:e,fieldSize:t,initialPlayer:this.userData.name})}},{key:"joinRoomOnServer",value:function(e){m.emit("joinRoom",{roomId:e,secondPlayer:this.userData.name})}},{key:"getGameUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.roomId;return"".concat(location.origin,"/game/").concat(e)}},{key:"setLinkForCurrentGame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.roomId;history.replaceState({},document.title,this.getGameUrl(e))}},{key:"showCreateRoomForm",value:function(){this.setState({createRoomForm:!0,joinRoomForm:!1})}},{key:"showJoinRoomForm",value:function(){this.setState({createRoomForm:!1,joinRoomForm:!0})}},{key:"createRoom",value:function(){var e=document.getElementById("fieldSize").value;this.createRoomOnServer(this.roomId,e),this.setLinkForCurrentGame()}},{key:"joinRoom",value:function(){var e=document.getElementById("roomId").value;this.setLinkForCurrentGame(e),this.joinGameFromLink()}},{key:"render",value:function(e){var t=e.createRoomForm,n=e.joinRoomForm;return t?this.createRoomForm:n?this.joinRoomForm:this.menuFormAsHTML}},{key:"menuFormAsHTML",get:function(){return'\n            <div class="menu-container">\n                <h2 class="mt0">MiniTicTacToe.io</h2>\n                \x3c!--<label for="userNameInput">Name:</label>\n                <input type="text" id="userNameInput" class="ui-input">\n                <br>--\x3e\n                <button onclick="showCreateRoomForm" class="ui-button">Create room</button>\n                <button onclick="showJoinRoomForm" class="ui-button">Join room</button>\n                <br><br>\n                <small>Made with Socket.io, Express and MiniComponent. Simon Raichl &copy; 2019, MIT.</small>\n            </div>\n        '}},{key:"createRoomForm",get:function(){return this.roomId=f(),'\n            <div class="menu-container">\n                <h2 class="mt0">Create room</h2>\n                <div>Room ID: <strong>'.concat(this.roomId,'</strong></div>\n                <div>\n                    Alternatively you can send link to your friend:\n                    <input type="text" onclick="selectInput" class="ui-input" readonly value="').concat(this.getGameUrl(),'">\n                    <small id="linkCopied">Link copied to clipboard!</small>\n                </div>\n                <br>\n                <label for="fieldSize">Field size (from 3 to 50): </label>\n                <input type="number" min="3" max="50" id="fieldSize" class="ui-input" value="3">\n                \x3c!--<br><br>\n                <label for="requiredLength">Required length to win: </label>\n                <input type="number" id="requiredLength" class="ui-input" value="3">--\x3e\n                <br>\n                <button onclick="createRoom" class="ui-button">Play</button>\n            </div>\n        ')}},{key:"joinRoomForm",get:function(){return'\n            <div class="menu-container">\n                <h2 class="mt0">Join room</h2>\n                <label for="userNameInput">Please type in Room ID:</label>\n                <input type="text" id="roomId" class="ui-input">\n                <br>\n                <button onclick="joinRoom" class="ui-button">Play</button>\n            </div>\n        '}}])&&y(n.prototype,o),r&&y(n,r),t}();function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(o=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function j(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function O(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var R=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=O(this,S(t).call(this,document.body,{field:[],currentPlayer:"o",userData:e}))).menuForm=new h(e),n.socketListeners(),n}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,s),n=t,(o=[{key:"socketListeners",value:function(){var e=this;m.on("updateField",function(t){try{var n=t.winner,o=t.field,r=o.join("").replace(/,/g,"");(n||r.length===Math.pow(o.length,2))&&setTimeout(function(){alert(n?"Player ".concat(n," has won!"):"Game is tied!"),e.gameOver()},50),e.setState(t)}catch(e){}}),m.on("opponentLeft",function(){alert("Your opponent left this game."),e.gameOver()})}},{key:"gameOver",value:function(){var e=this.menuForm,t=this.state.roomId;m.emit("removeRoom",t),history.replaceState({},document.title,"/"),e.setState(e.initialState)}},{key:"updateField",value:function(){var e=this.state,t=e.field,n=e.currentPlayer,o=e.roomId;m.emit("updateField",{field:t,currentPlayer:n,roomId:o})}},{key:"pickCell",value:function(e){var t=e.target,n=this.state,o=n.field,r=n.currentPlayer,i=n.activePlayer,a=n.winner;if(i!==n.userData.name||a)return!1;try{var u=k(t.dataset.coords.split(",").map(Number),2),c=u[0],l=u[1];""===o[c][l]&&(o[c][l]=r)}catch(e){return!1}this.updateField(),this.setState({field:o})}},{key:"pickCellOnEnter",value:function(e){"Enter"===e.key&&this.pickCell(e)}},{key:"render",value:function(e){var t=e.field;return'\n        <div class="field-area">\n            '.concat(t.length?t.map(function(e,t){return"\n            <div>\n                ".concat(e.map(function(e,n){return'\n                    <div class="field-cell"\n                         tabindex="1"\n                         onkeydown="pickCellOnEnter"\n                         onclick="pickCell"\n                         data-coords="'.concat(t,",").concat(n,'">\n                         \n                        ').concat(""!==e?'<div class="field-cell__mark">\n                            '.concat(e,"\n                        </div>"):"","\n                    </div>\n                ")}).join(""),"\n            </div>\n        ")}).join(""):"Loading...","\n        </div>\n        ")}}])&&j(n.prototype,o),r&&j(n,r),t}(),F={name:""};addEventListener("DOMContentLoaded",function(){new R(F)})}]);